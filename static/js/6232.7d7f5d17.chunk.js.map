{"version":3,"file":"static/js/6232.7d7f5d17.chunk.js","mappings":"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","sources":["pages/ai-advisor/InvestmentAdvice.tsx","services/geminiService.ts"],"sourcesContent":["import { TrendingUp } from '@mui/icons-material';\nimport {\n    Box,\n    Card,\n    CardContent,\n    CircularProgress,\n    Container,\n    Typography\n} from '@mui/material';\nimport { motion } from 'framer-motion';\nimport React, { useEffect, useState } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport geminiService from '../../services/geminiService';\nimport axiosInstance from '../../utils/axiosInstance';\n\nconst markdownStyles = {\n  heading1: {\n    color: '#A78BFA',\n    fontWeight: 700,\n    marginTop: '24px',\n    marginBottom: '16px',\n    fontSize: '1.5rem'\n  },\n  heading2: {\n    color: '#A78BFA',\n    fontWeight: 600,\n    marginTop: '24px',\n    marginBottom: '16px',\n    fontSize: '1.2rem'\n  },\n  heading3: {\n    color: '#A78BFA',\n    fontWeight: 600,\n    marginTop: '16px',\n    marginBottom: '8px',\n    fontSize: '1.1rem'\n  },\n  paragraph: {\n    color: '#A1A1AA',\n    marginBottom: '8px',\n    lineHeight: 1.7\n  },\n  listItem: {\n    color: '#A1A1AA',\n    marginBottom: '6px',\n    fontSize: '1rem',\n    marginLeft: '16px'\n  },\n  strong: {\n    color: '#A78BFA',\n    fontWeight: 600\n  }\n} as const;\n\nconst ReactMarkdownWrapper = ReactMarkdown as any;\n\nconst InvestmentAdvice: React.FC = () => {\n  // const theme = useTheme(); // Removed unused theme variable\n  const [loading, setLoading] = useState(true);\n  const [advice, setAdvice] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  // Removed unused states: transactions, investments\n  // const [transactions, setTransactions] = useState<any[]>([]);\n  // const [investments, setInvestments] = useState<any[]>([]);\n\n  useEffect(() => {\n    const fetchDataAndAdvise = async () => { // Renamed function for clarity\n      try {\n        setLoading(true);\n        // Fetch financial data\n        const [transactionsRes, investmentsRes] = await Promise.all([\n          axiosInstance.get('/api/transactions').catch(err => ({ data: { transactions: [] } })),\n          axiosInstance.get('/api/investments').catch(err => ({ data: [] }))\n        ]);\n\n        // Directly use fetched data without setting to state\n        const fetchedTransactions = transactionsRes.data.transactions || [];\n        const fetchedInvestments = investmentsRes.data || [];\n\n        // setTransactions(fetchedTransactions); // No longer needed\n        // setInvestments(fetchedInvestments); // No longer needed\n\n        if (fetchedTransactions.length > 0) {\n          // Generate AI investment advice\n          const aiAdvice = await geminiService.generateFinancialAdvice(\n            { transactions: fetchedTransactions, savings: [], investments: fetchedInvestments, budget: null },\n            'Dựa trên lịch sử giao dịch và đầu tư của tôi, hãy đưa ra tư vấn đầu tư chi tiết bao gồm:\\n1. Phân tích danh mục đầu tư hiện tại\\n2. Đề xuất các cơ hội đầu tư mới\\n3. Chiến lược phân bổ tài sản\\n4. Mức độ rủi ro và cách quản lý rủi ro'\n          );\n          setAdvice(aiAdvice);\n        } else {\n          setAdvice('Không có đủ dữ liệu giao dịch để tạo tư vấn đầu tư.');\n        }\n      } catch (error: any) {\n        console.error('Error:', error);\n        setError(error.message || 'Không thể tải dữ liệu tư vấn');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchDataAndAdvise(); // Call the renamed function\n  }, []);\n\n  const formatMessage = (content: string | null) => {\n    if (!content) return null;\n    return (\n      <Box className=\"markdown-content\">\n        <style>\n          {`\n            .markdown-content h1 { \n              color: ${markdownStyles.heading1.color};\n              font-weight: ${markdownStyles.heading1.fontWeight};\n              margin-top: ${markdownStyles.heading1.marginTop};\n              margin-bottom: ${markdownStyles.heading1.marginBottom};\n              font-size: ${markdownStyles.heading1.fontSize};\n            }\n            .markdown-content h2 {\n              color: ${markdownStyles.heading2.color};\n              font-weight: ${markdownStyles.heading2.fontWeight};\n              margin-top: ${markdownStyles.heading2.marginTop};\n              margin-bottom: ${markdownStyles.heading2.marginBottom};\n              font-size: ${markdownStyles.heading2.fontSize};\n            }\n            .markdown-content h3 {\n              color: ${markdownStyles.heading3.color};\n              font-weight: ${markdownStyles.heading3.fontWeight};\n              margin-top: ${markdownStyles.heading3.marginTop};\n              margin-bottom: ${markdownStyles.heading3.marginBottom};\n              font-size: ${markdownStyles.heading3.fontSize};\n            }\n            .markdown-content p {\n              color: ${markdownStyles.paragraph.color};\n              margin-bottom: ${markdownStyles.paragraph.marginBottom};\n              line-height: ${markdownStyles.paragraph.lineHeight};\n            }\n            .markdown-content li {\n              color: ${markdownStyles.listItem.color};\n              margin-bottom: ${markdownStyles.listItem.marginBottom};\n              font-size: ${markdownStyles.listItem.fontSize};\n              margin-left: ${markdownStyles.listItem.marginLeft};\n            }\n            .markdown-content strong {\n              color: ${markdownStyles.strong.color};\n              font-weight: ${markdownStyles.strong.fontWeight};\n            }\n          `}\n        </style>\n        <ReactMarkdownWrapper children={content || ''} />\n      </Box>\n    );\n  };\n\n  return (\n    <Container maxWidth=\"lg\" sx={{ py: 4 }}>\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.5 }}\n      >\n        <Typography\n          variant=\"h4\"\n          gutterBottom\n          sx={{\n            fontWeight: 700,\n            background: 'linear-gradient(45deg, #A78BFA, #8B5CF6)',\n            WebkitBackgroundClip: 'text',\n            WebkitTextFillColor: 'transparent',\n            mb: 4\n          }}\n        >\n          Tư Vấn Đầu Tư\n        </Typography>\n\n        <Card sx={{ \n          borderRadius: 3, \n          boxShadow: '0 8px 16px rgba(0,0,0,0.1)',\n          background: '#1C1C3D'\n        }}>\n          <CardContent>\n            <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>\n              <TrendingUp sx={{ fontSize: 32, color: '#A78BFA', mr: 2 }} />\n              <Typography variant=\"h6\" sx={{ color: '#FFFFFF' }}>Tư Vấn Đầu Tư Thông Minh</Typography>\n            </Box>\n            {loading ? (\n              <Box sx={{ display: 'flex', justifyContent: 'center', py: 3 }}>\n                <CircularProgress sx={{ color: '#A78BFA' }} />\n              </Box>\n            ) : error ? (\n              <Typography color=\"error\">{error}</Typography>\n            ) : (\n              <Box sx={{ color: '#A1A1AA', maxHeight: 350, overflowY: 'auto' }}>\n                {formatMessage(advice) || 'Chưa có dữ liệu tư vấn'}\n              </Box>\n            )}\n          </CardContent>\n        </Card>\n      </motion.div>\n    </Container>\n  );\n};\n\nexport default InvestmentAdvice; ","import { GoogleGenerativeAI } from \"@google/generative-ai\";\n\nconst API_KEY = process.env.REACT_APP_GEMINI_API_KEY || \"AIzaSyCWqESnXoAoAgMGLeQwsTntDEzS5hmdIyc\";\nconst genAI = new GoogleGenerativeAI(API_KEY);\n\nconst geminiService = {\n  generateFinancialAdvice: async (context: any, userInput: string) => {\n    try {\n      // Khởi tạo model với cấu hình cụ thể\n      const model = genAI.getGenerativeModel({ \n        model: \"gemini-1.5-flash\",\n        generationConfig: {\n          temperature: 0.7,\n          topK: 40,\n          topP: 0.95,\n          maxOutputTokens: 2048,\n        }\n      });\n\n      // Chuẩn bị prompt với ngữ cảnh\n      const prompt = `\n        Bạn là trợ lý tài chính cá nhân của FinanceFlow, một trang web giúp người dùng quản lý tài chính. \n        Bạn hỗ trợ người dùng bằng tiếng Việt, trả lời các câu hỏi về quản lý tài chính, tiết kiệm, đầu tư, ngân sách, thu chi, báo cáo tài chính, và các tính năng của FinanceFlow.\n        Hãy trả lời một cách tự nhiên, dễ hiểu, và chuyên nghiệp.\n\n        Thông tin tài chính của người dùng:\n        - Giao dịch: ${JSON.stringify(context.transactions, null, 2)}\n        - Tiết kiệm: ${JSON.stringify(context.savings, null, 2)}\n        - Đầu tư: ${JSON.stringify(context.investments, null, 2)}\n        - Ngân sách: ${JSON.stringify(context.budget, null, 2)}\n\n        Câu hỏi của người dùng: ${userInput}\n\n        Hãy phân tích thông tin và đưa ra lời khuyên chi tiết bằng tiếng Việt. Tập trung vào:\n        1. Phân tích tình hình tài chính hiện tại\n        2. Đề xuất cải thiện cụ thể\n        3. Các bước hành động tiếp theo\n      `;\n\n      // Gọi API để sinh nội dung\n      const result = await model.generateContent(prompt);\n      const response = await result.response;\n      return response.text();\n    } catch (error: any) {\n      console.error('Gemini API Error:', error);\n      throw new Error('Không thể kết nối với AI Assistant. Vui lòng thử lại sau.');\n    }\n  }\n};\n\nexport default geminiService; "],"names":["markdownStyles","color","fontWeight","marginTop","marginBottom","fontSize","lineHeight","marginLeft","ReactMarkdownWrapper","ReactMarkdown","InvestmentAdvice","loading","setLoading","useState","advice","setAdvice","error","setError","useEffect","async","transactionsRes","investmentsRes","Promise","all","axiosInstance","get","catch","err","data","transactions","fetchedTransactions","fetchedInvestments","length","aiAdvice","geminiService","generateFinancialAdvice","savings","investments","budget","console","message","fetchDataAndAdvise","_jsx","Container","maxWidth","sx","py","children","_jsxs","motion","div","initial","opacity","y","animate","transition","duration","Typography","variant","gutterBottom","background","WebkitBackgroundClip","WebkitTextFillColor","mb","Card","borderRadius","boxShadow","CardContent","Box","display","alignItems","TrendingUp","mr","justifyContent","CircularProgress","maxHeight","overflowY","content","className","concat","genAI","GoogleGenerativeAI","process","context","userInput","model","getGenerativeModel","generationConfig","temperature","topK","topP","maxOutputTokens","prompt","JSON","stringify","result","generateContent","response","text","Error"],"sourceRoot":""}