"use strict";(self.webpackChunkquanlythuchi=self.webpackChunkquanlythuchi||[]).push([[9987],{6058:(e,t,n)=>{n.d(t,{Fq:()=>b,yP:()=>f});var a=n(80045),r=n(89379),o=n(65043),s=n(17304);const i=["height","width","redraw","datasetIdKey","type","data","options","plugins","fallbackContent","updateMode"],c="label";function l(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function d(e,t){e.labels=t}function h(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c;const a=[];e.datasets=t.map((t=>{const o=e.datasets.find((e=>e[n]===t[n]));return o&&t.data&&!a.includes(o)?(a.push(o),Object.assign(o,t),o):(0,r.A)({},t)}))}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;const n={labels:[],datasets:[]};return d(n,e.labels),h(n,e.datasets,t),n}function x(e,t){const{height:n=150,width:c=300,redraw:x=!1,datasetIdKey:g,type:p,data:f,options:b,plugins:m=[],fallbackContent:y,updateMode:A}=e,j=(0,a.A)(e,i),v=(0,o.useRef)(null),k=(0,o.useRef)(null),C=()=>{v.current&&(k.current=new s.t1(v.current,{type:p,data:u(f,g),options:b&&(0,r.A)({},b),plugins:m}),l(t,k.current))},w=()=>{l(t,null),k.current&&(k.current.destroy(),k.current=null)};return(0,o.useEffect)((()=>{!x&&k.current&&b&&function(e,t){const n=e.options;n&&t&&Object.assign(n,t)}(k.current,b)}),[x,b]),(0,o.useEffect)((()=>{!x&&k.current&&d(k.current.config.data,f.labels)}),[x,f.labels]),(0,o.useEffect)((()=>{!x&&k.current&&f.datasets&&h(k.current.config.data,f.datasets,g)}),[x,f.datasets]),(0,o.useEffect)((()=>{k.current&&(x?(w(),setTimeout(C)):k.current.update(A))}),[x,b,f.labels,f.datasets,A]),(0,o.useEffect)((()=>{k.current&&(w(),setTimeout(C))}),[p]),(0,o.useEffect)((()=>(C(),()=>w())),[]),o.createElement("canvas",(0,r.A)({ref:v,role:"img",height:n,width:c},j),y)}const g=(0,o.forwardRef)(x);function p(e,t){return s.t1.register(t),(0,o.forwardRef)(((t,n)=>o.createElement(g,(0,r.A)((0,r.A)({},t),{},{ref:n,type:e}))))}const f=p("bar",s.A6),b=p("pie",s.P$)},47805:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(59662),r=n(70579);const o=(0,a.A)((0,r.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh")},48304:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(59662),r=n(70579);const o=(0,a.A)([(0,r.jsx)("path",{d:"m12 2-5.5 9h11z"},"0"),(0,r.jsx)("circle",{cx:"17.5",cy:"17.5",r:"4.5"},"1"),(0,r.jsx)("path",{d:"M3 13.5h8v8H3z"},"2")],"Category")},67957:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(59662),r=n(70579);const o=(0,a.A)((0,r.jsx)("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4"}),"AttachMoney")},70141:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(59662),r=n(70579);const o=(0,a.A)((0,r.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},94389:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(59662),r=n(70579);const o=(0,a.A)((0,r.jsx)("path",{d:"m16 18 2.29-2.29-4.88-4.88-4 4L2 7.41 3.41 6l6 6 4-4 6.3 6.29L22 12v6z"}),"TrendingDown")},99987:(e,t,n)=>{n.r(t),n.d(t,{default:()=>X});var a=n(89379),r=n(48304),o=n(59662),s=n(70579);const i=(0,o.A)((0,s.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack");var c=n(42796),l=n(94389),d=n(67957),h=n(70141),u=n(47805);const x=(0,o.A)((0,s.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download");var g=n(12110),p=n(96446),f=n(11906),b=n(78185),m=n(68903),y=n(85865),A=n(14194),j=n(53193),v=n(79190),k=n(69285),C=n(32143),w=n(67784),S=n(26494),D=n(17392),T=n(79650),E=n(71806),I=n(84882),W=n(28076),F=n(10039),M=n(73460),R=n(43845),N=n(90035),L=n(26600),P=n(35316),O=n(29347),_=n(34535),z=n(17304),V=n(37762),K=n(64857),H=n(65043),G=n(6058),B=n(83003),J=n(73216),Y=n(98421),q=n(84033);z.t1.register(z.PP,z.kc,z.E8,z.hE,z.m_,z.s$);const Q=(0,_.Ay)(g.A)((e=>{let{theme:t}=e;return{borderRadius:"16px",background:"dark"===t.palette.mode?"#1e2a38":"#fff",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transition:"transform 0.3s ease, box-shadow 0.3s ease","&:hover":{transform:"translateY(-5px)",boxShadow:"0 8px 20px rgba(0,0,0,0.15)"}}})),$=((0,_.Ay)(Q)((()=>({}))),(0,_.Ay)(p.A)((e=>{let{theme:t}=e;return{borderRadius:"16px",background:"dark"===t.palette.mode?"linear-gradient(135deg, rgba(30, 42, 56, 0.9), rgba(45, 55, 72, 0.9))":"linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(247, 250, 252, 0.9))",backdropFilter:"blur(10px)",border:"1px solid ".concat("dark"===t.palette.mode?"rgba(255,255,255,0.1)":"rgba(226, 232, 240, 0.8)"),padding:t.spacing(3),boxShadow:"dark"===t.palette.mode?"0 8px 32px rgba(0, 0, 0, 0.3)":"0 8px 32px rgba(0, 0, 0, 0.1)"}}))),U=(0,_.Ay)(f.A)((e=>{let{theme:t}=e;return{borderRadius:"12px",padding:t.spacing(1,3),textTransform:"none",fontWeight:600,transition:"all 0.2s ease","&:hover":{transform:"translateY(-2px)"}}})),X=()=>{const e=(0,J.Zp)(),t=(0,J.zy)(),{darkMode:n,currency:o}=(0,Y.w)(),g=(0,B.d4)((e=>e.subscription)),{plan:f}=g,[_,z]=(0,H.useState)([]),[X,Z]=(0,H.useState)([]),[ee,te]=(0,H.useState)([]),[ne,ae]=(0,H.useState)([]),[re,oe]=(0,H.useState)(!1),[se,ie]=(0,H.useState)({type:"expense",amount:"",category:"",description:"",date:(new Date).toISOString().split("T")[0],paymentMethod:"Ti\u1ec1n m\u1eb7t"}),[ce,le]=(0,H.useState)({totalIncome:0,totalExpense:0,balance:0}),[de,he]=(0,H.useState)("month"),[ue,xe]=(0,H.useState)(!0),[ge,pe]=(0,H.useState)(null),[fe,be]=(0,H.useState)(null),[me,ye]=(0,H.useState)({labels:[],incomeData:[],expenseData:[]}),[Ae,je]=(0,H.useState)("all"),[ve,ke]=(0,H.useState)(""),[Ce,we]=(0,H.useState)(""),[Se,De]=(0,H.useState)(""),Te=(0,H.useCallback)((async()=>{try{xe(!0);const e=(await q.A.get("/api/transactions")).data.transactions||[];console.log("\ud83d\udce1 Raw API data:",JSON.stringify(e,null,2));const t=e.map(((e,t)=>{let n;return n="object"===typeof e.category&&e.category?e.category._id:e.category||"",console.log("Giao d\u1ecbch ".concat(t,": category tr\u01b0\u1edbc ="),e.category,"sau =",n),(0,a.A)((0,a.A)({},e),{},{category:n})}));console.log("\ud83d\udce1 Giao d\u1ecbch sau khi chu\u1ea9n h\xf3a:",JSON.stringify(t,null,2)),z(t),Z(t),Fe(t)}catch(o){var t,n,r;pe((null===(t=o.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Kh\xf4ng th\u1ec3 t\u1ea3i giao d\u1ecbch"),401===(null===(r=o.response)||void 0===r?void 0:r.status)&&e("/login")}finally{xe(!1)}}),[e]),Ee=(0,H.useCallback)((async()=>{try{const e=(await q.A.get("/api/categories")).data||[];console.log("\ud83d\udce1 Danh m\u1ee5c l\u1ea5y t\u1eeb API:",JSON.stringify(e,null,2)),te(e),ie((t=>(0,a.A)((0,a.A)({},t),{},{category:e.length>0?e[0]._id:""})))}catch(e){te([]),ie((e=>(0,a.A)((0,a.A)({},e),{},{category:""})))}}),[]),Ie=(0,H.useCallback)((async()=>{try{const e=await q.A.get("/api/budgets");ae(e.data)}catch(n){var e,t;pe((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Kh\xf4ng th\u1ec3 t\u1ea3i ng\xe2n s\xe1ch")}}),[]),We=(0,H.useCallback)((async()=>{try{const e=await q.A.get("/api/transactions/trend");ye(e.data)}catch(e){pe("Kh\xf4ng th\u1ec3 t\u1ea3i xu h\u01b0\u1edbng chi ti\xeau")}}),[]);(0,H.useEffect)((()=>{var n;if(!localStorage.getItem("token"))return pe("Vui l\xf2ng \u0111\u0103ng nh\u1eadp"),void e("/login");const r=null===(n=t.state)||void 0===n?void 0:n.transactions;if(r&&Array.isArray(r)){console.log("\ud83d\udce1 State transactions:",JSON.stringify(r,null,2));const e=r.map(((e,t)=>{let n;return n="object"===typeof e.category&&e.category?e.category._id:e.category||"",console.log("State giao d\u1ecbch ".concat(t,": category tr\u01b0\u1edbc ="),e.category,"sau =",n),(0,a.A)((0,a.A)({},e),{},{category:n})}));console.log("\ud83d\udce1 State transactions sau khi chu\u1ea9n h\xf3a:",JSON.stringify(e,null,2)),z(e),Z(e),Fe(e),xe(!1)}else Te();Ee(),Ie(),"pro"===f&&We()}),[Te,Ee,Ie,We,e,f,t.state,t.key]);const Fe=e=>{const t=e.filter((e=>"income"===e.type)).reduce(((e,t)=>e+t.amount),0),n=e.filter((e=>"expense"===e.type)).reduce(((e,t)=>e+t.amount),0);le({totalIncome:t,totalExpense:n,balance:t-n})},Me=(0,H.useCallback)((e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"===o?"VND":"USD"}).format(e)),[o]),Re=(0,H.useCallback)((e=>{const t=e.filter((e=>"expense"===e.type)).reduce(((e,t)=>{const n="string"===typeof t.category?t.category:t.category&&"object"===typeof t.category?t.category._id:"";return e[n]=(e[n]||0)+t.amount,e}),{}),n=[];ne.forEach((e=>{const a=t[e.category]||0,r=ee.find((t=>t._id===e.category));if(a>e.amount){const t=r?r.name:"Kh\xf4ng x\xe1c \u0111\u1ecbnh";n.push('Chi ti\xeau cho "'.concat(t,'" (').concat(Me(a),") \u0111\xe3 v\u01b0\u1ee3t ng\xe2n s\xe1ch (").concat(Me(e.amount),")!"))}})),be(n.length>0?n.join("\n"):null)}),[ne,ee,Me]),Ne=(0,H.useCallback)((()=>{let e=[..._];if("range"===Ae&&ve&&Ce){const t=new Date(ve),n=new Date(Ce);e=e.filter((e=>{const a=new Date(e.date);return a>=t&&a<=n}))}else if("month"===Ae&&Se){const[t,n]=Se.split("-");e=e.filter((e=>{const a=new Date(e.date);return a.getFullYear()===Number(t)&&a.getMonth()===Number(n)-1}))}Z(e),Fe(e),Re(e)}),[_,Ae,ve,Ce,Se,Re]);(0,H.useEffect)((()=>{Ne()}),[Ne]);const Le={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:n?"#E0E0E0":"#333",font:{size:14}}},title:{display:!0,text:"Bi\u1ec3u \u0111\u1ed3 Thu nh\u1eadp & Chi ti\xeau",color:n?"#90CAF9":"#1976D2",font:{size:18}},tooltip:{backgroundColor:n?"#333":"#fff",titleColor:n?"#fff":"#333",bodyColor:n?"#fff":"#333",callbacks:{label:e=>"".concat(e.dataset.label,": ").concat(Me(e.raw))}}},scales:{x:{title:{display:!0,text:"day"===de?"Ng\xe0y":"week"===de?"Tu\u1ea7n":"Th\xe1ng",color:n?"#E0E0E0":"#333"},ticks:{color:n?"#E0E0E0":"#333"},grid:{color:n?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"}},y:{title:{display:!0,text:"S\u1ed1 ti\u1ec1n",color:n?"#E0E0E0":"#333"},ticks:{color:n?"#E0E0E0":"#333",callback:e=>Me(e).split(",")[0]},grid:{color:n?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"}}}},Pe=e=>{if(!e)return"Kh\xf4ng x\xe1c \u0111\u1ecbnh";if("string"===typeof e){const t=ee.find((t=>t._id===e));return t?t.name:"Kh\xf4ng x\xe1c \u0111\u1ecbnh"}return"object"===typeof e&&null!==e&&e.name||"Kh\xf4ng x\xe1c \u0111\u1ecbnh"};return ue?(0,s.jsxs)(p.A,{sx:{p:3},children:[(0,s.jsx)(b.A,{variant:"text",width:"50%",height:40}),(0,s.jsx)(m.Ay,{container:!0,spacing:2,sx:{mt:2},children:[...Array(3)].map(((e,t)=>(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:4,children:(0,s.jsx)(b.A,{variant:"rectangular",height:100})},t)))}),(0,s.jsx)(b.A,{variant:"rectangular",height:300,sx:{mt:3}}),(0,s.jsx)(b.A,{variant:"rectangular",height:400,sx:{mt:3}})]}):(0,s.jsxs)(p.A,{sx:{p:{xs:2,sm:3},minHeight:"100vh",background:n?"#121212":"#f8fafc"},children:[(0,s.jsxs)(p.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,flexDirection:{xs:"column",sm:"row"},gap:2},children:[(0,s.jsx)(y.A,{variant:"h4",sx:{fontSize:{xs:"1.5rem",sm:"1.8rem",md:"2rem"},fontWeight:600,background:"linear-gradient(45deg, #2563eb, #3b82f6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",letterSpacing:"-0.02em"},children:"Qu\u1ea3n l\xfd Giao d\u1ecbch"}),(0,s.jsxs)(p.A,{sx:{display:"flex",gap:1},children:[(0,s.jsx)(U,{variant:"outlined",startIcon:(0,s.jsx)(r.A,{}),onClick:()=>e("/categories"),sx:{borderColor:n?"#3b82f6":"#2563eb",color:n?"#3b82f6":"#2563eb"},children:"Danh m\u1ee5c"}),(0,s.jsx)(U,{variant:"outlined",startIcon:(0,s.jsx)(i,{}),onClick:()=>e("/dashboard"),sx:{borderColor:n?"#3b82f6":"#2563eb",color:n?"#3b82f6":"#2563eb"},children:"Quay l\u1ea1i"})]})]}),ge&&(0,s.jsx)(A.A,{severity:"error",sx:{mb:2,borderRadius:"12px"},children:ge}),fe&&(0,s.jsx)(A.A,{severity:"warning",sx:{mb:2,borderRadius:"12px",whiteSpace:"pre-line"},children:fe}),(0,s.jsx)($,{sx:{mb:3},children:(0,s.jsxs)(m.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:3,children:(0,s.jsxs)(j.A,{fullWidth:!0,children:[(0,s.jsx)(v.A,{children:"L\u1ecdc theo"}),(0,s.jsxs)(k.A,{value:Ae,onChange:e=>{je(e.target.value),ke(""),we(""),De(""),"all"===e.target.value&&Z(_)},sx:{borderRadius:"12px"},children:[(0,s.jsx)(C.A,{value:"all",children:"T\u1ea5t c\u1ea3"}),(0,s.jsx)(C.A,{value:"range",children:"Kho\u1ea3ng th\u1eddi gian"}),(0,s.jsx)(C.A,{value:"month",children:"Th\xe1ng"})]})]})}),"range"===Ae&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:3,children:(0,s.jsx)(w.A,{fullWidth:!0,label:"T\u1eeb ng\xe0y",type:"date",value:ve,onChange:e=>ke(e.target.value),InputLabelProps:{shrink:!0},sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:3,children:(0,s.jsx)(w.A,{fullWidth:!0,label:"\u0110\u1ebfn ng\xe0y",type:"date",value:Ce,onChange:e=>we(e.target.value),InputLabelProps:{shrink:!0},sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})})]}),"month"===Ae&&(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:3,children:(0,s.jsx)(w.A,{fullWidth:!0,label:"Ch\u1ecdn th\xe1ng",type:"month",value:Se,onChange:e=>De(e.target.value),InputLabelProps:{shrink:!0},sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:3,children:(0,s.jsx)(U,{fullWidth:!0,variant:"contained",onClick:Ne,sx:{background:"linear-gradient(45deg, #2563eb, #3b82f6)",color:"#fff",height:"56px"},children:"L\u1ecdc"})})]})}),(0,s.jsxs)(m.Ay,{container:!0,spacing:3,sx:{mb:3},children:[(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:4,children:(0,s.jsx)(Q,{children:(0,s.jsxs)(S.A,{children:[(0,s.jsxs)(p.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,s.jsx)(c.A,{sx:{color:"#4CAF50",mr:1}}),(0,s.jsx)(y.A,{variant:"h6",children:"Thu nh\u1eadp"})]}),(0,s.jsx)(y.A,{variant:"h5",sx:{color:"#4CAF50",fontWeight:600},children:Me(ce.totalIncome)})]})})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:4,children:(0,s.jsx)(Q,{children:(0,s.jsxs)(S.A,{children:[(0,s.jsxs)(p.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,s.jsx)(l.A,{sx:{color:"#FF5722",mr:1}}),(0,s.jsx)(y.A,{variant:"h6",children:"Chi ti\xeau"})]}),(0,s.jsx)(y.A,{variant:"h5",sx:{color:"#FF5722",fontWeight:600},children:Me(ce.totalExpense)})]})})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,sm:4,children:(0,s.jsx)(Q,{children:(0,s.jsxs)(S.A,{children:[(0,s.jsxs)(p.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,s.jsx)(d.A,{sx:{color:ce.balance>=0?"#2196F3":"#F44336",mr:1}}),(0,s.jsx)(y.A,{variant:"h6",children:"S\u1ed1 d\u01b0"})]}),(0,s.jsx)(y.A,{variant:"h5",sx:{color:ce.balance>=0?"#2196F3":"#F44336",fontWeight:600},children:Me(ce.balance)})]})})})]}),(0,s.jsxs)($,{sx:{mb:3},children:[(0,s.jsxs)(p.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,flexDirection:{xs:"column",sm:"row"},gap:2},children:[(0,s.jsx)(y.A,{variant:"h6",sx:{fontWeight:600},children:"Bi\u1ec3u \u0111\u1ed3 Thu - Chi"}),(0,s.jsxs)(p.A,{sx:{display:"flex",gap:1},children:[(0,s.jsx)(U,{variant:"day"===de?"contained":"outlined",onClick:()=>he("day"),sx:"day"===de?{background:"linear-gradient(45deg, #2563eb, #3b82f6)",color:"#fff"}:{borderColor:n?"#3b82f6":"#2563eb",color:n?"#3b82f6":"#2563eb"},children:"Ng\xe0y"}),(0,s.jsx)(U,{variant:"week"===de?"contained":"outlined",onClick:()=>he("week"),sx:"week"===de?{background:"linear-gradient(45deg, #2563eb, #3b82f6)",color:"#fff"}:{borderColor:n?"#3b82f6":"#2563eb",color:n?"#3b82f6":"#2563eb"},children:"Tu\u1ea7n"}),(0,s.jsx)(U,{variant:"month"===de?"contained":"outlined",onClick:()=>he("month"),sx:"month"===de?{background:"linear-gradient(45deg, #2563eb, #3b82f6)",color:"#fff"}:{borderColor:n?"#3b82f6":"#2563eb",color:n?"#3b82f6":"#2563eb"},children:"Th\xe1ng"})]})]}),(0,s.jsx)(p.A,{sx:{height:350},children:(0,s.jsx)(G.yP,{data:(()=>{const e=(e=>{const t={};return e.forEach((e=>{const n=new Date(e.date);let a="";a="day"===de?n.toLocaleDateString("vi-VN"):"week"===de?new Date(n.setDate(n.getDate()-n.getDay())).toLocaleDateString("vi-VN"):n.toLocaleString("vi-VN",{month:"short",year:"numeric"}),t[a]||(t[a]={income:0,expense:0}),"income"===e.type?t[a].income+=e.amount:t[a].expense+=e.amount})),t})(X),t=Object.keys(e).sort(((e,t)=>new Date(e).getTime()-new Date(t).getTime())),n=t.map((t=>e[t].income)),a=t.map((t=>e[t].expense));return"pro"===f&&me&&me.labels&&me.labels.length>0?{labels:me.labels,datasets:[{label:"Thu nh\u1eadp",data:me.incomeData||[],backgroundColor:"rgba(76, 175, 80, 0.7)",borderColor:"#4CAF50",borderWidth:1},{label:"Chi ti\xeau",data:me.expenseData||[],backgroundColor:"rgba(255, 87, 34, 0.7)",borderColor:"#FF5722",borderWidth:1}]}:{labels:t,datasets:[{label:"Thu nh\u1eadp",data:n,backgroundColor:"rgba(76, 175, 80, 0.7)",borderColor:"#4CAF50",borderWidth:1},{label:"Chi ti\xeau",data:a,backgroundColor:"rgba(255, 87, 34, 0.7)",borderColor:"#FF5722",borderWidth:1}]}})(),options:Le})})]}),(0,s.jsxs)(p.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,flexDirection:{xs:"column",sm:"row"},gap:2},children:[(0,s.jsx)(y.A,{variant:"h6",sx:{fontWeight:600},children:"Danh s\xe1ch Giao d\u1ecbch"}),(0,s.jsxs)(p.A,{sx:{display:"flex",gap:1},children:[(0,s.jsx)(U,{variant:"contained",startIcon:(0,s.jsx)(h.A,{}),onClick:()=>oe(!0),sx:{background:"linear-gradient(45deg, #2563eb, #3b82f6)",color:"#fff"},children:"Th\xeam Giao d\u1ecbch"}),(0,s.jsx)(D.A,{onClick:Te,sx:{borderRadius:"12px",border:"1px solid ".concat(n?"#3b82f6":"#2563eb"),color:n?"#3b82f6":"#2563eb"},children:(0,s.jsx)(u.A,{})}),("premium"===f||"pro"===f)&&(0,s.jsx)(U,{variant:"outlined",startIcon:(0,s.jsx)(x,{}),onClick:()=>{const e=new V.default;e.setFontSize(18),e.text("B\xe1o c\xe1o Giao d\u1ecbch T\xe0i ch\xednh",14,20),e.setFontSize(12),e.text("Ng\xe0y t\u1ea1o: ".concat((new Date).toLocaleDateString("vi-VN")),14,30),(0,K.default)(e,{startY:40,head:[["Ng\xe0y","Lo\u1ea1i","Danh m\u1ee5c","M\xf4 t\u1ea3","S\u1ed1 ti\u1ec1n","Ph\u01b0\u01a1ng th\u1ee9c"]],body:X.map((e=>{const t=ee.find((t=>"string"===typeof e.category?t._id===e.category:!(!e.category||"object"!==typeof e.category)&&t._id===e.category._id)),n=t?t.name:"Kh\xf4ng x\xe1c \u0111\u1ecbnh";return[new Date(e.date).toLocaleDateString("vi-VN"),"income"===e.type?"Thu nh\u1eadp":"Chi ti\xeau",n,e.description,Me(e.amount),e.paymentMethod]})),theme:"striped",headStyles:{fillColor:[25,118,210]}}),e.save("bao-cao-giao-dich.pdf")},sx:{borderColor:n?"#3b82f6":"#2563eb",color:n?"#3b82f6":"#2563eb"},children:"Xu\u1ea5t PDF"})]})]}),(0,s.jsx)($,{children:(0,s.jsx)(T.A,{sx:{maxHeight:500},children:(0,s.jsxs)(E.A,{stickyHeader:!0,children:[(0,s.jsx)(I.A,{children:(0,s.jsxs)(W.A,{children:[(0,s.jsx)(F.A,{sx:{fontWeight:600,background:n?"#1e2a38":"#f8fafc"},children:"Ng\xe0y"}),(0,s.jsx)(F.A,{sx:{fontWeight:600,background:n?"#1e2a38":"#f8fafc"},children:"Lo\u1ea1i"}),(0,s.jsx)(F.A,{sx:{fontWeight:600,background:n?"#1e2a38":"#f8fafc"},children:"Danh m\u1ee5c"}),(0,s.jsx)(F.A,{sx:{fontWeight:600,background:n?"#1e2a38":"#f8fafc"},children:"M\xf4 t\u1ea3"}),(0,s.jsx)(F.A,{sx:{fontWeight:600,background:n?"#1e2a38":"#f8fafc"},children:"S\u1ed1 ti\u1ec1n"}),(0,s.jsx)(F.A,{sx:{fontWeight:600,background:n?"#1e2a38":"#f8fafc"},children:"Ph\u01b0\u01a1ng th\u1ee9c"})]})}),(0,s.jsx)(M.A,{children:0===X.length?(0,s.jsx)(W.A,{children:(0,s.jsx)(F.A,{colSpan:6,align:"center",children:(0,s.jsx)(y.A,{sx:{py:3},children:"Kh\xf4ng c\xf3 giao d\u1ecbch n\xe0o"})})}):X.sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())).map((e=>(0,s.jsxs)(W.A,{hover:!0,sx:{"&:hover":{backgroundColor:n?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.02)"}},children:[(0,s.jsx)(F.A,{children:new Date(e.date).toLocaleDateString("vi-VN")}),(0,s.jsx)(F.A,{children:(0,s.jsx)(R.A,{icon:"income"===e.type?(0,s.jsx)(c.A,{}):(0,s.jsx)(l.A,{}),label:"income"===e.type?"Thu nh\u1eadp":"Chi ti\xeau",color:"income"===e.type?"success":"error",size:"small",sx:{borderRadius:"8px"}})}),(0,s.jsx)(F.A,{children:Pe(e.category)}),(0,s.jsx)(F.A,{children:e.description}),(0,s.jsx)(F.A,{sx:{color:"income"===e.type?"#4CAF50":"#FF5722",fontWeight:600},children:Me(e.amount)}),(0,s.jsx)(F.A,{children:e.paymentMethod})]},e._id)))})]})})}),(0,s.jsxs)(N.A,{open:re,onClose:()=>oe(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:"16px",background:n?"linear-gradient(135deg, #1e2a38 0%, #2d3748 100%)":"linear-gradient(135deg, #fff 0%, #f7fafc 100%)"}},children:[(0,s.jsx)(L.A,{sx:{fontSize:"1.25rem",fontWeight:600,color:n?"#fff":"#1a202c"},children:"Th\xeam Giao d\u1ecbch m\u1edbi"}),(0,s.jsx)(P.A,{children:(0,s.jsxs)(m.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,s.jsx)(m.Ay,{item:!0,xs:12,children:(0,s.jsxs)(j.A,{fullWidth:!0,children:[(0,s.jsx)(v.A,{children:"Lo\u1ea1i giao d\u1ecbch"}),(0,s.jsxs)(k.A,{value:se.type,onChange:e=>ie((0,a.A)((0,a.A)({},se),{},{type:e.target.value})),sx:{borderRadius:"12px"},children:[(0,s.jsx)(C.A,{value:"income",children:"Thu nh\u1eadp"}),(0,s.jsx)(C.A,{value:"expense",children:"Chi ti\xeau"})]})]})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,children:(0,s.jsx)(w.A,{fullWidth:!0,label:"S\u1ed1 ti\u1ec1n",type:"number",value:se.amount,onChange:e=>ie((0,a.A)((0,a.A)({},se),{},{amount:e.target.value})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,children:(0,s.jsxs)(j.A,{fullWidth:!0,children:[(0,s.jsx)(v.A,{children:"Danh m\u1ee5c"}),(0,s.jsx)(k.A,{value:se.category,onChange:e=>ie((0,a.A)((0,a.A)({},se),{},{category:e.target.value})),sx:{borderRadius:"12px"},children:ee.filter((e=>e.type===se.type)).map((e=>(0,s.jsx)(C.A,{value:e._id,children:e.name},e._id)))})]})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,children:(0,s.jsx)(w.A,{fullWidth:!0,label:"M\xf4 t\u1ea3",value:se.description,onChange:e=>ie((0,a.A)((0,a.A)({},se),{},{description:e.target.value})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,children:(0,s.jsx)(w.A,{fullWidth:!0,label:"Ng\xe0y",type:"date",value:se.date,onChange:e=>ie((0,a.A)((0,a.A)({},se),{},{date:e.target.value})),InputLabelProps:{shrink:!0},sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),(0,s.jsx)(m.Ay,{item:!0,xs:12,children:(0,s.jsxs)(j.A,{fullWidth:!0,children:[(0,s.jsx)(v.A,{children:"Ph\u01b0\u01a1ng th\u1ee9c thanh to\xe1n"}),(0,s.jsxs)(k.A,{value:se.paymentMethod,onChange:e=>ie((0,a.A)((0,a.A)({},se),{},{paymentMethod:e.target.value})),sx:{borderRadius:"12px"},children:[(0,s.jsx)(C.A,{value:"Ti\u1ec1n m\u1eb7t",children:"Ti\u1ec1n m\u1eb7t"}),(0,s.jsx)(C.A,{value:"Chuy\u1ec3n kho\u1ea3n",children:"Chuy\u1ec3n kho\u1ea3n"}),(0,s.jsx)(C.A,{value:"Th\u1ebb t\xedn d\u1ee5ng",children:"Th\u1ebb t\xedn d\u1ee5ng"})]})]})})]})}),(0,s.jsxs)(O.A,{sx:{p:3},children:[(0,s.jsx)(U,{onClick:()=>oe(!1),sx:{color:n?"#fff":"#1a202c"},children:"H\u1ee7y"}),(0,s.jsx)(U,{variant:"contained",onClick:async()=>{try{var e;const t=Number(se.amount);if(t<=0)throw new Error("S\u1ed1 ti\u1ec1n ph\u1ea3i l\u1edbn h\u01a1n 0");const n=ee.find((e=>e._id===se.category));if(console.log("\ud83d\udce1 Danh m\u1ee5c \u0111\u01b0\u1ee3c ch\u1ecdn:",n),!n)throw new Error("Danh m\u1ee5c kh\xf4ng h\u1ee3p l\u1ec7");if(n.type!==se.type)throw new Error('Danh m\u1ee5c "'.concat(n.name,'" ph\u1ea3i l\xe0 ').concat(n.type));const r={type:se.type,amount:t,category:n._id,description:se.description||"".concat("income"===se.type?"Thu nh\u1eadp":"Chi ti\xeau"," t\u1eeb ").concat(n.name),date:new Date(se.date).toISOString(),paymentMethod:se.paymentMethod,status:"completed"};console.log("\ud83d\udce1 Payload g\u1eedi \u0111i:",r);const o=(await q.A.post("/api/transactions",r)).data;console.log("\ud83d\udce1 Giao d\u1ecbch m\u1edbi t\u1eeb API:",o);const s=(0,a.A)((0,a.A)({},o),{},{category:"object"===typeof o.category&&o.category?o.category._id:o.category||""});console.log("\ud83d\udce1 Giao d\u1ecbch m\u1edbi sau chu\u1ea9n h\xf3a:",s),ie({type:"expense",amount:"",category:(null===(e=ee[0])||void 0===e?void 0:e._id)||"",description:"",date:(new Date).toISOString().split("T")[0],paymentMethod:"Ti\u1ec1n m\u1eb7t"}),oe(!1),z((e=>[...e,s])),Z((e=>[...e,s])),Fe([..._,s]),pe(null)}catch(r){var t,n;pe((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||r.message||"Kh\xf4ng th\u1ec3 th\xeam giao d\u1ecbch")}},sx:{background:"linear-gradient(45deg, #2563eb, #3b82f6)",color:"#fff"},children:"Th\xeam"})]})]})]})}}}]);
//# sourceMappingURL=9987.fc1e859e.chunk.js.map