"use strict";(self.webpackChunkquanlythuchi=self.webpackChunkquanlythuchi||[]).push([[7005],{10611:(e,t,n)=>{n.d(t,{A:()=>O});var r=n(57528),a=n(98587),o=n(58168),i=n(65043),s=n(58387),l=n(98610),c=n(83290),d=n(67266),u=n(10875),h=n(6803),m=n(34535),g=n(98206),x=n(92532),b=n(72372);function p(e){return(0,b.Ay)("MuiLinearProgress",e)}(0,x.A)("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);var f,v,A,y,j,w,k=n(70579);const C=["className","color","value","valueBuffer","variant"];let S,M,I,R,B,D;const P=(0,c.i7)(S||(S=f||(f=(0,r.A)(["\n  0% {\n    left: -35%;\n    right: 100%;\n  }\n\n  60% {\n    left: 100%;\n    right: -90%;\n  }\n\n  100% {\n    left: 100%;\n    right: -90%;\n  }\n"])))),L=(0,c.i7)(M||(M=v||(v=(0,r.A)(["\n  0% {\n    left: -200%;\n    right: 100%;\n  }\n\n  60% {\n    left: 107%;\n    right: -8%;\n  }\n\n  100% {\n    left: 107%;\n    right: -8%;\n  }\n"])))),N=(0,c.i7)(I||(I=A||(A=(0,r.A)(["\n  0% {\n    opacity: 1;\n    background-position: 0 -23px;\n  }\n\n  60% {\n    opacity: 0;\n    background-position: 0 -23px;\n  }\n\n  100% {\n    opacity: 1;\n    background-position: -200px -23px;\n  }\n"])))),T=(e,t)=>"inherit"===t?"currentColor":e.vars?e.vars.palette.LinearProgress["".concat(t,"Bg")]:"light"===e.palette.mode?(0,d.a)(e.palette[t].main,.62):(0,d.e$)(e.palette[t].main,.5),W=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["color".concat((0,h.A)(n.color))],t[n.variant]]}})((e=>{let{ownerState:t,theme:n}=e;return(0,o.A)({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:T(n,t.color)},"inherit"===t.color&&"buffer"!==t.variant&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},"buffer"===t.variant&&{backgroundColor:"transparent"},"query"===t.variant&&{transform:"rotate(180deg)"})})),q=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.dashed,t["dashedColor".concat((0,h.A)(n.color))]]}})((e=>{let{ownerState:t,theme:n}=e;const r=T(n,t.color);return(0,o.A)({position:"absolute",marginTop:0,height:"100%",width:"100%"},"inherit"===t.color&&{opacity:.3},{backgroundImage:"radial-gradient(".concat(r," 0%, ").concat(r," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})}),(0,c.AH)(R||(R=y||(y=(0,r.A)(["\n    animation: "," 3s infinite linear;\n  "]))),N)),z=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.bar,t["barColor".concat((0,h.A)(n.color))],("indeterminate"===n.variant||"query"===n.variant)&&t.bar1Indeterminate,"determinate"===n.variant&&t.bar1Determinate,"buffer"===n.variant&&t.bar1Buffer]}})((e=>{let{ownerState:t,theme:n}=e;return(0,o.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:"inherit"===t.color?"currentColor":(n.vars||n).palette[t.color].main},"determinate"===t.variant&&{transition:"transform .".concat(4,"s linear")},"buffer"===t.variant&&{zIndex:1,transition:"transform .".concat(4,"s linear")})}),(e=>{let{ownerState:t}=e;return("indeterminate"===t.variant||"query"===t.variant)&&(0,c.AH)(B||(B=j||(j=(0,r.A)(["\n      width: auto;\n      animation: "," 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;\n    "]))),P)})),H=(0,m.Ay)("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.bar,t["barColor".concat((0,h.A)(n.color))],("indeterminate"===n.variant||"query"===n.variant)&&t.bar2Indeterminate,"buffer"===n.variant&&t.bar2Buffer]}})((e=>{let{ownerState:t,theme:n}=e;return(0,o.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},"buffer"!==t.variant&&{backgroundColor:"inherit"===t.color?"currentColor":(n.vars||n).palette[t.color].main},"inherit"===t.color&&{opacity:.3},"buffer"===t.variant&&{backgroundColor:T(n,t.color),transition:"transform .".concat(4,"s linear")})}),(e=>{let{ownerState:t}=e;return("indeterminate"===t.variant||"query"===t.variant)&&(0,c.AH)(D||(D=w||(w=(0,r.A)(["\n      width: auto;\n      animation: "," 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;\n    "]))),L)})),O=i.forwardRef((function(e,t){const n=(0,g.b)({props:e,name:"MuiLinearProgress"}),{className:r,color:i="primary",value:c,valueBuffer:d,variant:m="indeterminate"}=n,x=(0,a.A)(n,C),b=(0,o.A)({},n,{color:i,variant:m}),f=(e=>{const{classes:t,variant:n,color:r}=e,a={root:["root","color".concat((0,h.A)(r)),n],dashed:["dashed","dashedColor".concat((0,h.A)(r))],bar1:["bar","barColor".concat((0,h.A)(r)),("indeterminate"===n||"query"===n)&&"bar1Indeterminate","determinate"===n&&"bar1Determinate","buffer"===n&&"bar1Buffer"],bar2:["bar","buffer"!==n&&"barColor".concat((0,h.A)(r)),"buffer"===n&&"color".concat((0,h.A)(r)),("indeterminate"===n||"query"===n)&&"bar2Indeterminate","buffer"===n&&"bar2Buffer"]};return(0,l.A)(a,p,t)})(b),v=(0,u.I)(),A={},y={bar1:{},bar2:{}};if("determinate"===m||"buffer"===m)if(void 0!==c){A["aria-valuenow"]=Math.round(c),A["aria-valuemin"]=0,A["aria-valuemax"]=100;let e=c-100;v&&(e=-e),y.bar1.transform="translateX(".concat(e,"%)")}else 0;if("buffer"===m)if(void 0!==d){let e=(d||0)-100;v&&(e=-e),y.bar2.transform="translateX(".concat(e,"%)")}else 0;return(0,k.jsxs)(W,(0,o.A)({className:(0,s.A)(f.root,r),ownerState:b,role:"progressbar"},A,{ref:t},x,{children:["buffer"===m?(0,k.jsx)(q,{className:f.dashed,ownerState:b}):null,(0,k.jsx)(z,{className:f.bar1,ownerState:b,style:y.bar1}),"determinate"===m?null:(0,k.jsx)(H,{className:f.bar2,ownerState:b,style:y.bar2})]}))}))},70141:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(59662),a=n(70579);const o=(0,r.A)((0,a.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},87005:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var r=n(89379),a=n(70141),o=n(96446),i=n(11906),s=n(85865),l=n(14194),c=n(53193),d=n(79190),u=n(69285),h=n(32143),m=n(68903),g=n(10611),x=n(67784),b=n(90035),p=n(26600),f=n(35316),v=n(29347),A=n(34535),y=n(65043),j=n(73216),w=n(98421),k=n(84033),C=n(70579);const S=["ti\u1ebft ki\u1ec7m","\u0111\u1ea7u t\u01b0","investment","savings","invest"],M=(0,A.Ay)(o.A)((e=>{let{theme:t}=e;return{borderRadius:"16px",background:"dark"===t.palette.mode?"linear-gradient(135deg, #1e2a38 0%, #2d3748 100%)":"linear-gradient(135deg, #fff 0%, #f7fafc 100%)",border:"1px solid ".concat("dark"===t.palette.mode?"rgba(255,255,255,0.1)":"rgba(226, 232, 240, 0.8)"),boxShadow:"dark"===t.palette.mode?"0 8px 32px rgba(0, 0, 0, 0.3)":"0 8px 32px rgba(0, 0, 0, 0.1)",padding:t.spacing(3)}})),I=(0,A.Ay)(i.A)((e=>{let{theme:t}=e;return{borderRadius:"12px",padding:t.spacing(1,3),textTransform:"none",fontWeight:600,transition:"all 0.2s ease","&:hover":{transform:"translateY(-2px)"}}})),R=()=>{const e=(0,j.Zp)(),{darkMode:t,currency:n}=(0,w.w)(),[i,A]=(0,y.useState)(!0),[R,B]=(0,y.useState)(null),[D,P]=(0,y.useState)(null),[L,N]=(0,y.useState)([]),[T,W]=(0,y.useState)([]),[q,z]=(0,y.useState)([]),[H,O]=(0,y.useState)("monthly"),[K,V]=(0,y.useState)(!1),[E,F]=(0,y.useState)({name:"",type:"expense",icon:"\ud83d\udcca",color:"#2563eb"}),[Y,U]=(0,y.useState)(null);(0,y.useEffect)((()=>{(async()=>{try{A(!0);const[e,t]=await Promise.all([k.A.get("/api/transactions"),k.A.get("/api/categories")]);N(e.data.transactions||[]),z(t.data||[]),(e=>{const t=e.filter((e=>"income"===e.type)).reduce(((e,t)=>e+t.amount),0),n=e.filter((e=>"expense"===e.type)).reduce(((e,t)=>e+t.amount),0),r=t/Math.max(1,new Set(e.map((e=>new Date(e.date).getMonth()+"-"+new Date(e.date).getFullYear()))).size),a=n/Math.max(1,new Set(e.map((e=>new Date(e.date).getMonth()+"-"+new Date(e.date).getFullYear()))).size),o=r-a,i=Math.min(50,Math.max(10,Math.round(o/r*100))),s=Math.round(r*(i/100));let l="";l=i>=30?"B\u1ea1n c\xf3 th\u1ec3 ti\u1ebft ki\u1ec7m m\u1ed9t kho\u1ea3n l\u1edbn! H\xe3y c\xe2n nh\u1eafc \u0111\u1ea7u t\u01b0 d\xe0i h\u1ea1n.":i>=20?"Kh\u1ea3 n\u0103ng ti\u1ebft ki\u1ec7m t\u1ed1t! H\xe3y duy tr\xec th\xf3i quen chi ti\xeau hi\u1ec7n t\u1ea1i.":i>=10?"B\u1ea1n c\xf3 th\u1ec3 b\u1eaft \u0111\u1ea7u v\u1edbi m\u1ed9t kho\u1ea3n ti\u1ebft ki\u1ec7m nh\u1ecf v\xe0 t\u0103ng d\u1ea7n theo th\u1eddi gian.":"H\xe3y xem x\xe9t l\u1ea1i c\xe1c kho\u1ea3n chi ti\xeau \u0111\u1ec3 t\u0103ng kh\u1ea3 n\u0103ng ti\u1ebft ki\u1ec7m.",U({amount:s,percentage:i,description:l,monthlyIncome:r,monthlyExpense:a})})(e.data.transactions||[]),G(e.data.transactions||[],t.data||[])}catch(a){var t,n,r;B((null===(t=a.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Kh\xf4ng th\u1ec3 t\u1ea3i d\u1eef li\u1ec7u"),401===(null===(r=a.response)||void 0===r?void 0:r.status)&&e("/login")}finally{A(!1)}})()}),[e]);const G=(e,t)=>{const n=t.filter((e=>"expense"===e.type&&!S.some((t=>e.name.toLowerCase().includes(t))))),r=e.filter((e=>"expense"===e.type)),a=new Map,o=new Map(t.map((e=>[e._id,e.name])));n.forEach((e=>{a.set(e.name,{total:0,count:0,name:e.name})})),r.forEach((e=>{const t=o.get(e.category)||"Kh\xe1c";if(!S.some((e=>t.toLowerCase().includes(e)))){a.has(t)||a.set(t,{total:0,count:0,name:t});const n=a.get(t);n&&(n.total+=e.amount,n.count+=1)}}));const i=new Set(r.map((e=>new Date(e.date).getMonth()+"-"+new Date(e.date).getFullYear()))).size||1,s=Array.from(a.values()).map((e=>{let{total:t,name:n}=e;return{name:n,suggestedAmount:Math.round(t/i)}}));W(s.map((e=>({category:e.name,amount:e.suggestedAmount,period:"monthly"}))))},X=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"===n?"VND":"USD"}).format(e);return(0,C.jsxs)(o.A,{sx:{p:{xs:2,sm:3},minHeight:"100vh",background:t?"#121212":"#f8fafc"},children:[(0,C.jsx)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,flexDirection:{xs:"column",sm:"row"},gap:2},children:(0,C.jsx)(s.A,{variant:"h4",sx:{fontSize:{xs:"1.5rem",sm:"1.8rem",md:"2rem"},fontWeight:600,background:"linear-gradient(45deg, #2563eb, #3b82f6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",letterSpacing:"-0.02em"},children:"Thi\u1ebft l\u1eadp Ng\xe2n s\xe1ch Chi ti\xeau"})}),R&&(0,C.jsx)(l.A,{severity:"error",sx:{mb:2,borderRadius:"12px"},children:R}),D&&(0,C.jsx)(l.A,{severity:"success",sx:{mb:2,borderRadius:"12px"},children:D}),Y&&(0,C.jsx)(M,{sx:{mb:3},children:(0,C.jsxs)(o.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"flex-start",sm:"center"},justifyContent:"space-between",gap:2},children:[(0,C.jsxs)(o.A,{children:[(0,C.jsx)(s.A,{variant:"h6",sx:{fontWeight:600,mb:1},children:"G\u1ee3i \xfd ti\u1ebft ki\u1ec7m c\u1ee7a b\u1ea1n"}),(0,C.jsx)(s.A,{variant:"body1",sx:{mb:1},children:Y.description}),(0,C.jsxs)(o.A,{sx:{mt:2},children:[(0,C.jsxs)(s.A,{variant:"body2",color:"text.secondary",children:["Thu nh\u1eadp h\xe0ng th\xe1ng: ",X(Y.monthlyIncome)]}),(0,C.jsxs)(s.A,{variant:"body2",color:"text.secondary",children:["Chi ti\xeau h\xe0ng th\xe1ng: ",X(Y.monthlyExpense)]})]})]}),(0,C.jsxs)(o.A,{sx:{display:"flex",flexDirection:"column",alignItems:{xs:"flex-start",sm:"flex-end"}},children:[(0,C.jsx)(s.A,{variant:"h5",sx:{fontWeight:600,color:"#2563eb",mb:1},children:X(Y.amount)}),(0,C.jsxs)(s.A,{variant:"subtitle2",sx:{color:t?"rgba(255,255,255,0.7)":"rgba(0,0,0,0.6)"},children:[Y.percentage,"% thu nh\u1eadp h\xe0ng th\xe1ng"]})]})]})}),(0,C.jsxs)(M,{children:[(0,C.jsxs)(o.A,{sx:{mb:3},children:[(0,C.jsx)(s.A,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Thi\u1ebft l\u1eadp chu k\u1ef3 ng\xe2n s\xe1ch"}),(0,C.jsx)(s.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Thi\u1ebft l\u1eadp ng\xe2n s\xe1ch cho c\xe1c kho\u1ea3n chi ti\xeau th\xf4ng th\u01b0\u1eddng."}),(0,C.jsxs)(c.A,{fullWidth:!0,children:[(0,C.jsx)(d.A,{children:"Chu k\u1ef3"}),(0,C.jsxs)(u.A,{value:H,onChange:e=>{const t=e.target.value;O(t),W(T.map((e=>(0,r.A)((0,r.A)({},e),{},{period:t}))))},sx:{borderRadius:"12px"},children:[(0,C.jsx)(h.A,{value:"monthly",children:"H\xe0ng th\xe1ng"}),(0,C.jsx)(h.A,{value:"weekly",children:"H\xe0ng tu\u1ea7n"})]})]})]}),(0,C.jsxs)(o.A,{sx:{mb:3},children:[(0,C.jsx)(s.A,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Ng\xe2n s\xe1ch theo danh m\u1ee5c"}),(0,C.jsx)(m.Ay,{container:!0,spacing:3,children:T.map(((e,n)=>{const{currentSpending:a,percentageUsed:i,isOverBudget:l}=(e=>{const t=L.filter((t=>{var n;const r=null===(n=q.find((e=>e._id===t.category)))||void 0===n?void 0:n.name;return"expense"===t.type&&r===e.category})).reduce(((e,t)=>e+t.amount),0);return{currentSpending:t,percentageUsed:e.amount>0?t/e.amount*100:0,isOverBudget:t>e.amount}})(e);return(0,C.jsx)(m.Ay,{item:!0,xs:12,md:6,children:(0,C.jsxs)(M,{sx:{p:2,border:l?"2px solid #ef4444":void 0},children:[(0,C.jsxs)(o.A,{sx:{mb:2},children:[(0,C.jsx)(s.A,{variant:"subtitle1",sx:{fontWeight:500,mb:1},children:e.category}),(0,C.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,C.jsx)(g.A,{variant:"determinate",value:Math.min(100,i),sx:{flexGrow:1,height:8,borderRadius:4,backgroundColor:t?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)","& .MuiLinearProgress-bar":{backgroundColor:l?"#ef4444":"#2563eb"}}}),(0,C.jsxs)(s.A,{variant:"body2",color:"text.secondary",children:[Math.round(i),"%"]})]})]}),(0,C.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,C.jsx)(x.A,{size:"small",type:"number",value:e.amount,onChange:e=>{const t=e.target.value.replace(/^0+/,"")||"0";((e,t,n)=>{const a=[...T];a[e]=(0,r.A)((0,r.A)({},a[e]),{},{[t]:n}),W(a)})(n,"amount",Number(t))},sx:{width:"150px","& .MuiOutlinedInput-root":{borderRadius:"12px"}}}),(0,C.jsxs)(s.A,{variant:"body2",color:"text.secondary",children:["\u0110\xe3 chi: ",X(a)]})]})]})},n)}))})]}),(0,C.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",mt:4},children:[(0,C.jsx)(I,{startIcon:(0,C.jsx)(a.A,{}),onClick:()=>V(!0),sx:{color:t?"#3b82f6":"#2563eb"},children:"Th\xeam danh m\u1ee5c"}),(0,C.jsx)(I,{variant:"contained",onClick:async()=>{try{if(T.some((e=>!e.category||!e.amount)))return void B("Vui l\xf2ng \u0111i\u1ec1n \u0111\u1ea7y \u0111\u1ee7 th\xf4ng tin cho t\u1ea5t c\u1ea3 ng\xe2n s\xe1ch");await k.A.post("/api/budgets",{budgets:T}),P("L\u01b0u ng\xe2n s\xe1ch th\xe0nh c\xf4ng"),setTimeout((()=>{e("/dashboard/reports/budget")}),1500)}catch(r){var t,n;B((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Kh\xf4ng th\u1ec3 l\u01b0u ng\xe2n s\xe1ch")}},sx:{background:"linear-gradient(45deg, #2563eb, #3b82f6)",color:"#fff"},children:"L\u01b0u ng\xe2n s\xe1ch"})]})]}),(0,C.jsxs)(b.A,{open:K,onClose:()=>V(!1),PaperProps:{sx:{borderRadius:"16px",background:t?"linear-gradient(135deg, #1e2a38 0%, #2d3748 100%)":"linear-gradient(135deg, #fff 0%, #f7fafc 100%)"}},children:[(0,C.jsx)(p.A,{children:"Th\xeam danh m\u1ee5c m\u1edbi"}),(0,C.jsx)(f.A,{children:(0,C.jsxs)(m.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,C.jsx)(m.Ay,{item:!0,xs:12,children:(0,C.jsx)(x.A,{fullWidth:!0,label:"T\xean danh m\u1ee5c",value:E.name,onChange:e=>F((0,r.A)((0,r.A)({},E),{},{name:e.target.value})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),(0,C.jsx)(m.Ay,{item:!0,xs:12,children:(0,C.jsx)(x.A,{fullWidth:!0,label:"Icon",value:E.icon,onChange:e=>F((0,r.A)((0,r.A)({},E),{},{icon:e.target.value})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})}),(0,C.jsx)(m.Ay,{item:!0,xs:12,children:(0,C.jsx)(x.A,{fullWidth:!0,label:"M\xe0u s\u1eafc",type:"color",value:E.color,onChange:e=>F((0,r.A)((0,r.A)({},E),{},{color:e.target.value})),sx:{"& .MuiOutlinedInput-root":{borderRadius:"12px"}}})})]})}),(0,C.jsxs)(v.A,{children:[(0,C.jsx)(I,{onClick:()=>V(!1),children:"H\u1ee7y"}),(0,C.jsx)(I,{onClick:async()=>{try{if(!E.name)return void B("Vui l\xf2ng nh\u1eadp t\xean danh m\u1ee5c");if(S.some((e=>E.name.toLowerCase().includes(e))))return void B("Kh\xf4ng th\u1ec3 th\xeam danh m\u1ee5c ti\u1ebft ki\u1ec7m ho\u1eb7c \u0111\u1ea7u t\u01b0");const e=(await k.A.post("/api/categories",E)).data;z((t=>[...t,e])),W((t=>[...t,{category:e.name,amount:0,period:H}])),P("Th\xeam danh m\u1ee5c m\u1edbi th\xe0nh c\xf4ng"),V(!1),F({name:"",type:"expense",icon:"\ud83d\udcca",color:"#2563eb"})}catch(n){var e,t;B((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Kh\xf4ng th\u1ec3 th\xeam danh m\u1ee5c m\u1edbi")}},variant:"contained",children:"Th\xeam"})]})]})]})}}}]);
//# sourceMappingURL=7005.02d22d42.chunk.js.map