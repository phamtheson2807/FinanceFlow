"use strict";(self.webpackChunkquanlythuchi=self.webpackChunkquanlythuchi||[]).push([[2803],{32803:(e,n,t)=>{t.r(n),t.d(n,{default:()=>W});var o=t(26240),i=t(96446),a=t(85865),r=t(81637),s=t(90035),l=t(26600),c=t(35316),d=t(29347),u=t(11906),h=t(86328),p=t(79722),x=t(55487),g=t(65043),m=t(89379),A=t(63471),f=t(95540),v=t(69285),y=t(32143),b=t(67784),j=t(51787),C=t(17392),w=t(79650),S=t(63336),k=t(71806),L=t(84882),P=t(28076),T=t(10039),D=t(58093),I=t(73460),M=t(70579);const F=["Ng\u01b0\u1eddi d\xf9ng","S\u1ed1 ti\u1ec1n","Danh m\u1ee5c","Lo\u1ea1i","Ng\xe0y","M\xf4 t\u1ea3","Vi ph\u1ea1m","H\xe0nh \u0111\u1ed9ng"],N=["user","amount","category","type","date","description","description","description"],R=e=>{var n,t,o;let{transactions:r,onDelete:h,onUpdate:p}=e;const[R,W]=(0,g.useState)("date"),[V,_]=(0,g.useState)("asc"),[E,z]=(0,g.useState)(null),[H,K]=(0,g.useState)(""),[B,X]=(0,g.useState)(null);(0,g.useEffect)((()=>{console.log("Transactions received:",r)}),[r]);const q=(0,g.useMemo)((()=>{const e=(r||[]).map((e=>e.user&&(e.user.name||e.user.email||e.user._id)||"Kh\xf4ng x\xe1c \u0111\u1ecbnh")).filter((e=>null!==e&&void 0!==e));return Array.from(new Set(e))}),[r]),G=(0,g.useMemo)((()=>(r||[]).filter((e=>{var n,t,o,i;const a=e.user&&(e.user.name||e.user.email||e.user._id)||"Kh\xf4ng x\xe1c \u0111\u1ecbnh",r=!E||a===E,s=!H||((null===(n=e.description)||void 0===n?void 0:n.toLowerCase().includes(H.toLowerCase()))||(null===(t=e.category)||void 0===t?void 0:t.toLowerCase().includes(H.toLowerCase()))||a.toLowerCase().includes(H.toLowerCase())||String(e.amount).includes(H)||(null===(o=e.type)||void 0===o?void 0:o.toLowerCase().includes(H.toLowerCase()))||(null===(i=e.date)||void 0===i?void 0:i.includes(H))||!1);return r&&s})).sort(((e,n)=>{let t,o;return"user"===R?(t=e.user&&(e.user.name||e.user.email||e.user._id)||"",o=n.user&&(n.user.name||n.user.email||n.user._id)||""):"amount"===R?(t=e.amount,o=n.amount):"date"===R?(t=new Date(e.date).getTime(),o=new Date(n.date).getTime()):(t=e[R]&&"string"===typeof e[R]?e[R]:"",o=n[R]&&"string"===typeof n[R]?n[R]:""),"number"===typeof t&&"number"===typeof o?"asc"===V?t-o:o-t:"asc"===V?String(t).localeCompare(String(o)):String(o).localeCompare(String(t))}))),[r,E,H,R,V]),O=()=>{K(""),z(null)};return(0,M.jsxs)(x.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[(0,M.jsxs)(i.A,{sx:{mb:2,display:"flex",gap:2,alignItems:"center",bgcolor:"#e9f0f7",p:2,borderRadius:1},children:[(0,M.jsxs)(v.A,{value:E||"",onChange:e=>z(e.target.value),displayEmpty:!0,sx:{minWidth:150},renderValue:e=>e||"T\u1ea5t c\u1ea3 ng\u01b0\u1eddi d\xf9ng",children:[(0,M.jsx)(y.A,{value:"",children:"T\u1ea5t c\u1ea3 ng\u01b0\u1eddi d\xf9ng"}),q.map((e=>(0,M.jsx)(y.A,{value:e,children:e},e)))]}),(0,M.jsx)(b.A,{variant:"outlined",placeholder:"T\xecm ki\u1ebfm giao d\u1ecbch...",value:H,onChange:e=>K(e.target.value),sx:{flexGrow:1,"& .MuiOutlinedInput-root":{borderRadius:2}},InputProps:{startAdornment:(0,M.jsx)(j.A,{position:"start",children:(0,M.jsx)(a.A,{children:"\ud83d\udd0d"})}),endAdornment:H&&(0,M.jsx)(j.A,{position:"end",children:(0,M.jsx)(C.A,{onClick:O,size:"small",children:(0,M.jsx)(a.A,{children:"\u2715"})})})}}),(0,M.jsx)(u.A,{variant:"contained",onClick:O,sx:{bgcolor:"#1976d2",color:"white"},children:"Xem t\u1ea5t c\u1ea3"})]}),(0,M.jsx)(w.A,{component:S.A,sx:{bgcolor:"#f5f7fa",borderRadius:2,boxShadow:"none",border:"1px solid #e0e0e0",maxHeight:{xs:400,sm:600},overflow:"auto"},children:(0,M.jsxs)(k.A,{stickyHeader:!0,"aria-label":"b\u1ea3ng giao d\u1ecbch",children:[(0,M.jsx)(L.A,{children:(0,M.jsx)(P.A,{sx:{bgcolor:"#f0f2f5",borderBottom:"2px solid #e0e0e0"},children:F.map(((e,n)=>(0,M.jsx)(T.A,{sx:{color:"#333",fontWeight:"bold",fontFamily:"Poppins, sans-serif",bgcolor:"#f0f2f5",borderRight:"1px solid #e0e0e0","&:last-child":{borderRight:"none"}},children:(0,M.jsx)(D.A,{active:R===N[n],direction:R===N[n]?V:"asc",onClick:()=>{return _(R===(e=N[n])&&"asc"===V?"desc":"asc"),void W(e);var e},sx:{color:"#333","&:hover":{color:"#000"},"&.Mui-active":{color:"#000"}},children:e})},e)))})}),(0,M.jsx)(I.A,{children:G.length>0?G.map(((e,n)=>{return(0,M.jsxs)(P.A,{sx:{bgcolor:n%2===0?"white":"#fafbff",borderBottom:"1px solid #e0e0e0"},children:[(0,M.jsx)(T.A,{sx:{fontFamily:"Poppins, sans-serif",color:"#333",padding:"8px"},children:(r=e.user,r&&(r.name||r.email||r._id)||"Kh\xf4ng x\xe1c \u0111\u1ecbnh")}),(0,M.jsx)(T.A,{sx:{fontFamily:"Poppins, sans-serif",color:"income"===e.type?"#2e7d32":"#d32f2f",padding:"8px"},children:(o=e.amount,new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(o))}),(0,M.jsx)(T.A,{sx:{fontFamily:"Poppins, sans-serif",color:"#666",padding:"8px"},children:e.category}),(0,M.jsx)(T.A,{sx:{fontFamily:"Poppins, sans-serif",color:"income"===e.type?"#2e7d32":"#d32f2f",padding:"8px"},children:"income"===e.type?"Thu":"Chi"}),(0,M.jsx)(T.A,{sx:{fontFamily:"Poppins, sans-serif",color:"#666",padding:"8px"},children:(t=e.date,new Date(t).toLocaleDateString("vi-VN"))}),(0,M.jsx)(T.A,{sx:{fontFamily:"Poppins, sans-serif",color:"#666",padding:"8px"},children:e.description||"-"}),(0,M.jsx)(T.A,{sx:{fontFamily:"Poppins, sans-serif",color:"#666",padding:"8px"},children:e.isViolating?(0,M.jsx)(a.A,{color:"error",children:"C\xf3"}):"Kh\xf4ng"}),(0,M.jsx)(T.A,{align:"center",sx:{padding:"8px"},children:(0,M.jsxs)(i.A,{sx:{display:"flex",gap:1,justifyContent:"center"},children:[(0,M.jsx)(C.A,{color:"primary",onClick:()=>X(e),sx:{p:.5},children:(0,M.jsx)(f.A,{})}),(0,M.jsx)(C.A,{color:"error",onClick:()=>h(e._id),sx:{p:.5,"& .MuiSvgIcon-root":{color:"#d32f2f"}},children:(0,M.jsx)(A.A,{})})]})})]},e._id);var t,o,r})):(0,M.jsx)(P.A,{children:(0,M.jsx)(T.A,{colSpan:8,align:"center",children:(0,M.jsx)(x.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:(0,M.jsx)(a.A,{variant:"h6",color:"textSecondary",sx:{fontFamily:"Poppins, sans-serif",color:"#666"},children:"Kh\xf4ng c\xf3 d\u1eef li\u1ec7u giao d\u1ecbch"})})})})})]})}),B&&(0,M.jsxs)(s.A,{open:!!B,onClose:()=>X(null),maxWidth:"sm",fullWidth:!0,children:[(0,M.jsx)(l.A,{sx:{fontFamily:"Poppins, sans-serif",fontWeight:"bold",color:"#1E3A8A"},children:"C\u1eadp nh\u1eadt giao d\u1ecbch"}),(0,M.jsxs)(c.A,{sx:{p:3},children:[(0,M.jsx)(b.A,{fullWidth:!0,label:"T\xean ng\u01b0\u1eddi d\xf9ng",value:(null===(n=B.user)||void 0===n?void 0:n.name)||"",onChange:e=>{const n=B.user?(0,m.A)((0,m.A)({},B.user),{},{name:e.target.value}):{name:e.target.value,email:"",_id:""};X((0,m.A)((0,m.A)({},B),{},{user:n}))},sx:{mb:2}}),(0,M.jsx)(b.A,{fullWidth:!0,label:"Email ng\u01b0\u1eddi d\xf9ng",value:(null===(t=B.user)||void 0===t?void 0:t.email)||"",onChange:e=>{const n=B.user?(0,m.A)((0,m.A)({},B.user),{},{email:e.target.value}):{name:"",email:e.target.value,_id:""};X((0,m.A)((0,m.A)({},B),{},{user:n}))},sx:{mb:2}}),(0,M.jsx)(b.A,{fullWidth:!0,label:"ID ng\u01b0\u1eddi d\xf9ng",value:(null===(o=B.user)||void 0===o?void 0:o._id)||"",disabled:!0,sx:{mb:2}}),(0,M.jsx)(b.A,{fullWidth:!0,label:"S\u1ed1 ti\u1ec1n",type:"number",value:B.amount,onChange:e=>X((0,m.A)((0,m.A)({},B),{},{amount:Number(e.target.value)})),sx:{mb:2}}),(0,M.jsx)(b.A,{fullWidth:!0,label:"Danh m\u1ee5c",value:B.category,onChange:e=>X((0,m.A)((0,m.A)({},B),{},{category:e.target.value})),sx:{mb:2}}),(0,M.jsxs)(v.A,{fullWidth:!0,value:B.type,onChange:e=>X((0,m.A)((0,m.A)({},B),{},{type:e.target.value})),sx:{mb:2},children:[(0,M.jsx)(y.A,{value:"income",children:"Thu"}),(0,M.jsx)(y.A,{value:"expense",children:"Chi"})]}),(0,M.jsx)(b.A,{fullWidth:!0,label:"Ng\xe0y",type:"date",value:B.date.slice(0,10),onChange:e=>X((0,m.A)((0,m.A)({},B),{},{date:e.target.value})),InputLabelProps:{shrink:!0},sx:{mb:2}}),(0,M.jsx)(b.A,{fullWidth:!0,label:"M\xf4 t\u1ea3",value:B.description,onChange:e=>X((0,m.A)((0,m.A)({},B),{},{description:e.target.value})),sx:{mb:2}})]}),(0,M.jsxs)(d.A,{children:[(0,M.jsx)(u.A,{onClick:()=>X(null),sx:{color:"#777"},children:"H\u1ee7y"}),(0,M.jsx)(u.A,{onClick:()=>{B&&(p(B),X(null))},variant:"contained",color:"primary",children:"L\u01b0u"})]})]})]})},W=()=>{const e=(0,o.A)(),[n,t]=(0,g.useState)([]),[m,A]=(0,g.useState)(!0),[f,v]=(0,g.useState)(null),[y,b]=(0,g.useState)(null);return(0,g.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("Token kh\xf4ng t\u1ed3n t\u1ea1i");const n=(await p.A.get("http://localhost:5000/api/admin/transactions",{headers:{Authorization:"Bearer ".concat(e)}})).data.transactions||[];console.log("D\u1eef li\u1ec7u giao d\u1ecbch t\u1eeb API:",n),t(n)}catch(f){console.error("L\u1ed7i khi t\u1ea3i giao d\u1ecbch:",f),p.A.isAxiosError(f)?f.response?v("L\u1ed7i API: ".concat(f.response.status," - ").concat(f.response.data.message||"Kh\xf4ng th\u1ec3 k\u1ebft n\u1ed1i \u0111\u1ebfn server")):f.request?v("Kh\xf4ng th\u1ec3 k\u1ebft n\u1ed1i \u0111\u1ebfn server. Vui l\xf2ng ki\u1ec3m tra k\u1ebft n\u1ed1i m\u1ea1ng."):v("L\u1ed7i khi g\u1eedi y\xeau c\u1ea7u. Vui l\xf2ng th\u1eed l\u1ea1i."):v("L\u1ed7i kh\xf4ng x\xe1c \u0111\u1ecbnh. Vui l\xf2ng th\u1eed l\u1ea1i.")}finally{A(!1)}})()}),[]),(0,M.jsxs)(i.A,{sx:{p:{xs:2,sm:3,md:4},bgcolor:"#f0f4f8",minHeight:"calc(100vh - 64px)"},children:[f&&(0,M.jsx)(a.A,{sx:{color:"error.main",mb:2,textAlign:"center"},children:f}),(0,M.jsx)(x.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.8,type:"spring",stiffness:200,damping:20},children:(0,M.jsx)(a.A,{variant:"h3",gutterBottom:!0,sx:{fontFamily:"Poppins, sans-serif",fontWeight:"bold",color:"#1E3A8A",textShadow:"0 2px 5px rgba(0,0,0,0.1)"},children:"Qu\u1ea3n L\xfd Giao D\u1ecbch"})}),m?(0,M.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,M.jsx)(x.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},children:(0,M.jsx)(r.A,{size:60,sx:{color:e.palette.primary.main}})})}):(0,M.jsx)(x.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.8,delay:.4,type:"spring",stiffness:200,damping:20},children:(0,M.jsx)(R,{transactions:n,onDelete:e=>b(e),onUpdate:async e=>{try{const o=localStorage.getItem("token");if(!o)throw new Error("Token kh\xf4ng t\u1ed3n t\u1ea1i");const i=await p.A.put("http://localhost:5000/api/admin/transactions/".concat(e._id),e,{headers:{Authorization:"Bearer ".concat(o)}});t(n.map((n=>n._id===e._id?i.data:n)))}catch(f){console.error("L\u1ed7i khi c\u1eadp nh\u1eadt giao d\u1ecbch:",f),v("Kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt giao d\u1ecbch. Vui l\xf2ng th\u1eed l\u1ea1i.")}}})}),(0,M.jsxs)(s.A,{open:!!y,onClose:()=>b(null),TransitionComponent:h.A,transitionDuration:400,children:[(0,M.jsx)(l.A,{sx:{fontFamily:"Poppins, sans-serif",fontWeight:"bold",bgcolor:"rgba(245, 245, 245, 0.95)",color:"#1E3A8A",py:2,boxShadow:"0 2px 10px rgba(0,0,0,0.05)"},children:"X\xe1c nh\u1eadn x\xf3a"}),(0,M.jsx)(c.A,{sx:{bgcolor:"rgba(245, 245, 245, 0.95)",py:3,px:4},children:(0,M.jsx)(a.A,{sx:{fontFamily:"Poppins, sans-serif",color:"#555"},children:"B\u1ea1n c\xf3 ch\u1eafc mu\u1ed1n x\xf3a giao d\u1ecbch n\xe0y? H\xe0nh \u0111\u1ed9ng n\xe0y kh\xf4ng th\u1ec3 ho\xe0n t\xe1c."})}),(0,M.jsxs)(d.A,{sx:{bgcolor:"rgba(245, 245, 245, 0.95)",px:4,py:2},children:[(0,M.jsx)(u.A,{onClick:()=>b(null),sx:{fontFamily:"Poppins, sans-serif",color:"#777","&:hover":{color:"#1E3A8A"}},children:"H\u1ee7y"}),(0,M.jsx)(u.A,{onClick:()=>y&&(async e=>{try{const o=localStorage.getItem("token");if(!o)throw new Error("Token kh\xf4ng t\u1ed3n t\u1ea1i");await p.A.delete("http://localhost:5000/api/admin/transactions/".concat(e),{headers:{Authorization:"Bearer ".concat(o)}}),t(n.filter((n=>n._id!==e))),b(null)}catch(f){console.error("L\u1ed7i khi x\xf3a giao d\u1ecbch:",f),v("Kh\xf4ng th\u1ec3 x\xf3a giao d\u1ecbch. Vui l\xf2ng th\u1eed l\u1ea1i.")}})(y),variant:"contained",color:"error",sx:{fontFamily:"Poppins, sans-serif",background:"linear-gradient(45deg, #f44336, #d32f2f)",borderRadius:3,px:4,py:1,boxShadow:"0 5px 15px rgba(0,0,0,0.1)","&:hover":{background:"linear-gradient(45deg, #ff5f52, #e64a19)"}},children:"X\xf3a"})]})]})]})}},58093:(e,n,t)=>{t.d(n,{A:()=>j});var o=t(98587),i=t(58168),a=t(98610),r=t(58387),s=t(65043),l=t(66236),c=t(59662),d=t(70579);const u=(0,c.A)((0,d.jsx)("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");var h=t(34535),p=t(98206),x=t(6803),g=t(92532),m=t(72372);function A(e){return(0,m.Ay)("MuiTableSortLabel",e)}const f=(0,g.A)("MuiTableSortLabel",["root","active","icon","iconDirectionDesc","iconDirectionAsc"]),v=["active","children","className","direction","hideSortIcon","IconComponent"],y=(0,h.Ay)(l.A,{name:"MuiTableSortLabel",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:t}=e;return[n.root,t.active&&n.active]}})((e=>{let{theme:n}=e;return{cursor:"pointer",display:"inline-flex",justifyContent:"flex-start",flexDirection:"inherit",alignItems:"center","&:focus":{color:(n.vars||n).palette.text.secondary},"&:hover":{color:(n.vars||n).palette.text.secondary,["& .".concat(f.icon)]:{opacity:.5}},["&.".concat(f.active)]:{color:(n.vars||n).palette.text.primary,["& .".concat(f.icon)]:{opacity:1,color:(n.vars||n).palette.text.secondary}}}})),b=(0,h.Ay)("span",{name:"MuiTableSortLabel",slot:"Icon",overridesResolver:(e,n)=>{const{ownerState:t}=e;return[n.icon,n["iconDirection".concat((0,x.A)(t.direction))]]}})((e=>{let{theme:n,ownerState:t}=e;return(0,i.A)({fontSize:18,marginRight:4,marginLeft:4,opacity:0,transition:n.transitions.create(["opacity","transform"],{duration:n.transitions.duration.shorter}),userSelect:"none"},"desc"===t.direction&&{transform:"rotate(0deg)"},"asc"===t.direction&&{transform:"rotate(180deg)"})})),j=s.forwardRef((function(e,n){const t=(0,p.b)({props:e,name:"MuiTableSortLabel"}),{active:s=!1,children:l,className:c,direction:h="asc",hideSortIcon:g=!1,IconComponent:m=u}=t,f=(0,o.A)(t,v),j=(0,i.A)({},t,{active:s,direction:h,hideSortIcon:g,IconComponent:m}),C=(e=>{const{classes:n,direction:t,active:o}=e,i={root:["root",o&&"active"],icon:["icon","iconDirection".concat((0,x.A)(t))]};return(0,a.A)(i,A,n)})(j);return(0,d.jsxs)(y,(0,i.A)({className:(0,r.A)(C.root,c),component:"span",disableRipple:!0,ownerState:j,ref:n},f,{children:[l,g&&!s?null:(0,d.jsx)(b,{as:m,className:(0,r.A)(C.icon),ownerState:j})]}))}))},63471:(e,n,t)=>{var o=t(24994);n.A=void 0;var i=o(t(40039)),a=t(70579);n.A=(0,i.default)((0,a.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},79650:(e,n,t)=>{t.d(n,{A:()=>m});var o=t(58168),i=t(98587),a=t(65043),r=t(58387),s=t(98610),l=t(98206),c=t(34535),d=t(92532),u=t(72372);function h(e){return(0,u.Ay)("MuiTableContainer",e)}(0,d.A)("MuiTableContainer",["root"]);var p=t(70579);const x=["className","component"],g=(0,c.Ay)("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(e,n)=>n.root})({width:"100%",overflowX:"auto"}),m=a.forwardRef((function(e,n){const t=(0,l.b)({props:e,name:"MuiTableContainer"}),{className:a,component:c="div"}=t,d=(0,i.A)(t,x),u=(0,o.A)({},t,{component:c}),m=(e=>{const{classes:n}=e;return(0,s.A)({root:["root"]},h,n)})(u);return(0,p.jsx)(g,(0,o.A)({ref:n,as:c,className:(0,r.A)(m.root,a),ownerState:u},d))}))},95540:(e,n,t)=>{var o=t(24994);n.A=void 0;var i=o(t(40039)),a=t(70579);n.A=(0,i.default)((0,a.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")}}]);
//# sourceMappingURL=2803.135c0791.chunk.js.map